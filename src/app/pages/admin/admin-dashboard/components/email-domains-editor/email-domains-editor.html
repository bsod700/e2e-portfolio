<div class="email-domains-editor">
  <div class="header">
    <h2>Disposable Email Domains</h2>
    <p class="description">
      Manage the list of disposable or test email domains that should be blocked by validation.
    </p>
  </div>

  <div class="status-messages">
    @if (error) {
      <p class="status-message error">{{ error }}</p>
    }
    @if (successMessage) {
      <p class="status-message success">{{ successMessage }}</p>
    }
  </div>

  <div class="add-domain-form">
    <label for="new-domain">Add domain</label>
    <div class="input-row">
      <input
        id="new-domain"
        type="text"
        [(ngModel)]="newDomain"
        [disabled]="saving"
        placeholder="e.g. tempmail.com"
      />
      <button
        type="button"
        class="btn-primary"
        (click)="addDomain()"
        [disabled]="saving || !newDomain.trim()"
      >
        Add
      </button>
    </div>
  </div>

  <div class="domains-list">
    @if (loading) {
      <p class="loading">Loading domains...</p>
    } @else {
      @if (!domains.length) {
        <p class="empty-state">
          No domains in the block list yet. Add domains above to start blocking them.
        </p>
      } @else {
        <ul>
          @for (domain of domains; track trackByDomain($index, domain)) {
            <li class="domain-item" [class.editing]="isEditing($index)">
              <div class="domain-main">
                @if (!isEditing($index)) {
                  <span class="domain">{{ domain }}</span>
                } @else {
                  <input
                    type="text"
                    [(ngModel)]="editDomainValue"
                    [disabled]="saving"
                    placeholder="e.g. tempmail.com"
                    class="domain-input"
                  />
                }
              </div>
              <div class="section-actions">
                @if (!isEditing($index)) {
                  <button
                    type="button"
                    class="btn-icon"
                    title="Edit"
                    (click)="startEdit($index, domain)"
                    [disabled]="saving"
                  >
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path
                        d="M11.333 2.667a1.333 1.333 0 0 1 1.885 1.885L5.333 12.667l-2.667.667.667-2.667L11.333 2.667z"
                        stroke="currentColor"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="btn-icon btn-delete"
                    title="Delete"
                    (click)="deleteDomain(domain)"
                    [disabled]="saving"
                  >
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                      <path
                        d="M4 4L12 12M12 4L4 12"
                        stroke="currentColor"
                        stroke-width="1.5"
                        stroke-linecap="round"
                      />
                    </svg>
                  </button>
                } @else {
                  <button
                    type="button"
                    class="btn-small"
                    (click)="saveEdit(domain, $index)"
                    [disabled]="saving || !editDomainValue.trim()"
                  >
                    Save
                  </button>
                  <button
                    type="button"
                    class="btn-small btn-secondary"
                    (click)="cancelEdit()"
                    [disabled]="saving"
                  >
                    Cancel
                  </button>
                }
              </div>
            </li>
          }
        </ul>
      }
    }
  </div>
</div>


